<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles/style.css" />
    <title>Vite App</title>
  </head>
  <body>
    <header id="header">
      <div class="header__content"></div>
    </header>

    <div id="app">
      <section class="panel-control">
        <button id="menu">Btn</button>
        <ul id="panel-control__ul">
          <li><button class="li__btn" id="ir-inicio">Inicio</button></li>
          <li>
            <button class="li__btn" id="ir_agregarVehiculo">
              Agregar Vehiculo
            </button>
          </li>
          <li>
            <button class="li__btn" id="ir_eliminarVehiculo">
              Eliminar Vehiculo
            </button>
          </li>
          <li><button class="li__btn">Monitorear</button></li>
          <li><button class="li__btn">Agregar Usuario</button></li>
          <li><button class="li__btn">Eliminar Usuario</button></li>
          <li><button class="li__btn">Ver Usuarios</button></li>
          <li><button class="li__btn">Agregar Marca</button></li>
          <li><button class="li__btn">Eliminar Marca</button></li>
        </ul>
      </section>
      <div id="panel-variable">
        <!-- <main class="main-agregarVehiculo">
          <h3>Eliminar Vehiculo</h3>

          <div class="input-box">
            <label for="placa">Ingrese la placa</label>
            <input
              type="text"
              id="buscador-placa"
              name="placa"
              placeholder="M180988"
            />
          </div>

          <section class="section-buscados"></section>
        </main> -->
      </div>
    </div>

    <dialog id="dialog">
      <img src="" alt="" id="dialog__img" />
      <p id="dialog__p"></p>
      <button id="cerrar-dialog" class="btn-dialog">Cerrar</button>
    </dialog>

    <script type="module" src="/main.js"></script>
    <!-- <script>
      const buscadorPlaca = document.querySelector("#buscador-placa");
      buscadorPlaca.addEventListener("input", (event) => {
        const value = event.target.value.toLowerCase();

        const cards = document.querySelectorAll(".card__vehiculo");
        cards.forEach((e) => {
          const content = e.textContent.toLowerCase();
          if (!content.includes(value)) {
            e.classList.remove("show");
            e.classList.add("ocultar");
            return;
          }
          e.classList.remove("ocultar");
          e.classList.add("show");
        });
      });
      document.addEventListener("DOMContentLoaded", async () => {
        const fetching = await fetch(`http://localhost:3000/getVehiculos`);
        const repuesta = await fetching.json();
        console.log(repuesta);

        const fragment = document.createRange().createContextualFragment(`
            <section section class="card__vehiculo">
                  <div class="card__top">
                    <div class="vehiculo__data">
                      <p class="data__modelo"></p>
                    </div>
                    <img
                      src=""
                      alt="toyota yaris"
                      class="vehiculo__img"
                    />
                  </div>
                  <hr />
                  <div class="card__bottom">
                    <div class="v__data">
                      <p class="v__yeear">2010</p>
                      <p class="v__tipo"></p>
                      <p class="v__placa"></p>
                    </div>
                    <button class="vehiculo__buttom">Eliminar</button>
                  </div>
                </section>
        `);

        const pegar = document.querySelector(".section-buscados");
        //

        for (let i = 0; i < repuesta.length; i++) {
          const vehiculo = repuesta[i];
          const nombreMarca = vehiculo.Marca.marca;
          const nombreModelo = vehiculo.Modelo.modelo;
          const dataConcat = `${nombreMarca} ${nombreModelo}`;
          const url =
            "https://pibmgbatahdbrcdxjqbv.supabase.co/storage/v1/object/public/autosimagenes/" +
            vehiculo.imagenURL;

          const nuevo = fragment.cloneNode(true);
          const data = nuevo.querySelector(".data__modelo");
          const img = nuevo.querySelector(".vehiculo__img");
          const placa = nuevo.querySelector(".v__placa");
          const tipo = nuevo.querySelector(".v__tipo");
          const btnEliminar = nuevo.querySelector(".vehiculo__buttom");

          data.textContent = dataConcat;
          img.setAttribute("src", url);
          placa.textContent = vehiculo.placa;
          tipo.textContent = vehiculo.Tipo.tipo;

          btnEliminar.addEventListener("click", async () => {
            const placaVehiculo = repuesta[i].placa;
            const fetchingBorrado = await fetch(
              `http://localhost:3000/deleteVehiculo?borrar=${placaVehiculo}`,
              {
                method: "DELETE",
              }
            );
            const borrado = await fetchingBorrado.text();
            console.log(borrado);
          });

          pegar.append(nuevo);
        }
      });
    </script> -->

    <script>
      let estado = true;
      const btn = document.querySelector("#menu");
      const panelControl = document.querySelector(".panel-control");
      const ul = document.querySelector("ul");
      const lis = ul.querySelectorAll("li");

      btn.addEventListener("click", () => {
        if (estado) {
          estado = false;
          ul.style.display = "none";
          panelControl.classList.add("maxcontent");
          return;
        }
        estado = true;
        ul.style.display = "flex";
        panelControl.classList.remove("maxcontent");
      });
    </script>
  </body>
</html>
